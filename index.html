<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ouzbek Global - RAPPORT D'ARCHITECTURE ET DE SÉCURISATION - SRV-PROMETHEUS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: #f5f7fa;
            color: #1e293b;
            line-height: 1.6;
            padding: 2rem 1rem;
        }

        .report-container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 40px -15px rgba(0,20,40,0.2);
            overflow: hidden;
        }

        .report-header {
            background: #0a2c3d;
            color: white;
            padding: 2.5rem 3rem;
        }

        .report-header h1 {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            letter-spacing: -0.01em;
        }

        .report-header .subtitle {
            font-size: 1.2rem;
            opacity: 0.85;
            font-weight: 400;
        }

        .meta-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
        }

        .meta-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0.7;
        }

        .meta-value {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .report-content {
            padding: 2.5rem 3rem;
        }

        h2 {
            font-size: 1.6rem;
            font-weight: 600;
            color: #0a2c3d;
            margin: 2.2rem 0 1rem 0;
            padding-bottom: 0.4rem;
            border-bottom: 2px solid #e0e7ef;
        }

        h2:first-of-type {
            margin-top: 0;
        }

        h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e4a6d;
            margin: 1.5rem 0 0.5rem 0;
        }

        h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #0a2c3d;
            margin: 1.2rem 0 0.3rem 0;
        }

        .executive-summary {
            background: #f0f6fb;
            border-radius: 16px;
            padding: 1.5rem 2rem;
            margin: 1.5rem 0;
            border-left: 5px solid #0a2c3d;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.95rem;
        }

        th {
            background: #f0f4f8;
            font-weight: 600;
            padding: 0.75rem 1rem;
            text-align: left;
            color: #1e293b;
        }

        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .stat-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #0a2c3d;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #475569;
            text-transform: uppercase;
        }

        .image-container {
            margin: 2rem 0;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }

        .image-container img {
            width: 100%;
            height: auto;
            display: block;
            border-bottom: 1px solid #eef2f6;
        }

        .image-caption {
            background: #f9fafc;
            padding: 0.8rem 1.2rem;
            font-size: 0.9rem;
            color: #475569;
            font-weight: 500;
            border-top: 1px solid #e2e8f0;
        }

        .image-caption span {
            font-family: 'SF Mono', monospace;
            background: #edf2f7;
            padding: 0.2rem 0.5rem;
            border-radius: 6px;
            font-size: 0.8rem;
            color: #2d4b6e;
            margin-left: 0.5rem;
        }

        .placeholder-image {
            background: #f9fcff;
            border: 2px dashed #9bb7d4;
            border-radius: 20px;
            padding: 2rem 1.5rem;
            margin: 1.8rem 0;
            text-align: center;
            color: #2c577c;
        }

        .placeholder-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            opacity: 0.7;
        }

        .placeholder-label {
            font-weight: 600;
            font-size: 1rem;
        }

        .placeholder-path {
            font-size: 0.8rem;
            color: #5e7a99;
            font-family: 'SF Mono', monospace;
            margin-top: 0.3rem;
        }

        .justification-box {
            background: #f4f9ff;
            border-left: 4px solid #1e4a6d;
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            border-radius: 0 12px 12px 0;
        }

        .badge {
            display: inline-block;
            background: #dcfce7;
            color: #166534;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            margin-right: 0.5rem;
        }

        hr {
            border: none;
            border-top: 2px dashed #bac8d9;
            margin: 2.5rem 0;
        }

        pre {
            background: #f1f5f9;
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            border: 1px solid #d1d9e6;
            white-space: pre-wrap;
            font-family: 'SF Mono', monospace;
            overflow-x: auto;
        }

        ul, ol {
            margin-left: 1.5rem;
            margin-bottom: 1.5rem;
        }

        li {
            margin-bottom: 0.3rem;
        }

        .signature-block {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 2px solid #e2e8f0;
        }

        .signature-line {
            width: 250px;
            border-bottom: 2px solid #0a2c3d;
            margin: 0.5rem 0;
        }

        @media (max-width: 650px) {
            .report-header, .report-content { padding: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="report-container">
        <!-- Header -->
        <div class="report-header">
            <h1>RAPPORT D'ARCHITECTURE ET DE SÉCURISATION</h1>
            <div class="subtitle">Plateforme de Supervision Centralisée (Prometheus + Grafana)</div>
            <div class="meta-grid">
                <div class="meta-item"><span class="meta-label">Date</span><span class="meta-value">17 février 2026</span></div>
                <div class="meta-item"><span class="meta-label">Rédacteur</span><span class="meta-value">Sugira Yannick</span></div>
                <div class="meta-item"><span class="meta-label">Version</span><span class="meta-value">1.0 - Synthèse Direction</span></div>
                <div class="meta-item"><span class="meta-label">Domaine</span><span class="meta-value">ouzbek.global</span></div>
                <div class="meta-item"><span class="meta-label">Serveur principal</span><span class="meta-value">172.16.11.11</span></div>
            </div>
        </div>

        <!-- Content -->
        <div class="report-content">
            <!-- 1. CONTEXTE ET OBJECTIFS -->
            <h2>1. CONTEXTE ET OBJECTIFS</h2>
            
            <p>Dans le cadre de la refonte complète de son système d'information, l'entreprise Ouzbek Global (activité e-commerce) doit se doter d'une <strong>plateforme de supervision centralisée</strong> permettant une visibilité en temps réel sur l'état de santé de l'ensemble de l'infrastructure.</p>

            <h3>Objectifs poursuivis :</h3>
            <table>
                <tr><th>#</th><th>Objectif</th><th>Bénéfice attendu</th></tr>
                <tr><td>1</td><td><strong>Collecte centralisée des métriques</strong> (Prometheus)</td><td>Détection proactive des pannes avant impact métier</td></tr>
                <tr><td>2</td><td><strong>Tableaux de bord de visualisation</strong> (Grafana)</td><td>Visibilité instantanée pour la direction et les équipes techniques</td></tr>
                <tr><td>3</td><td><strong>Supervision des 15 serveurs critiques</strong> (12 Linux, 3 Windows)</td><td>Anticipation des besoins en ressources (CPU, RAM, disque)</td></tr>
                <tr><td>4</td><td><strong>Configuration d'alertes</strong></td><td>Notification automatique en cas d'anomalie</td></tr>
                <tr><td>5</td><td><strong>Sécurisation complète de la plateforme</strong></td><td>Conformité avec les exigences ANSSI, RGPD et ISO 27001</td></tr>
            </table>

            <hr>

            <!-- 2. PÉRIMÈTRE ET PRINCIPES DE SÉCURITÉ -->
            <h2>2. PÉRIMÈTRE ET PRINCIPES DE SÉCURITÉ</h2>

            <p>Le périmètre couvert par ce déploiement inclut :</p>
            <ul>
                <li><strong>Le serveur de supervision</strong> (Prometheus + Grafana) sur <code>172.16.11.11</code></li>
                <li><strong>12 serveurs Linux</strong> supervisés via Node Exporter</li>
                <li><strong>3 serveurs Windows</strong> supervisés via Windows Exporter (dont le PDC <code>172.16.11.1</code>)</li>
                <li><strong>L'ensemble des services critiques</strong> (AD, DNS, DHCP, bases de données, applications web)</li>
            </ul>

            <h3>Principes de sécurité appliqués :</h3>
            <table>
                <tr><th>Principe</th><th>Implémentation</th><th>Référentiel</th></tr>
                <tr><td><strong>Authentification forte</strong></td><td>Mots de passe complexes (12 caractères), MFA sur SSH</td><td>ANSSI, ISO 27001 A.9.4</td></tr>
                <tr><td><strong>Moindre privilège</strong></td><td>RBAC strict, groupes de rôles distincts</td><td>ANSSI, ISO 27001 A.9.2</td></tr>
                <tr><td><strong>Séparation des tâches</strong></td><td>Groupes admin, user-mgmt, pwd-reset, auditor, monitoring</td><td>ISO 27001 A.9.2.3</td></tr>
                <tr><td><strong>Chiffrement systématique</strong></td><td>HTTPS sur Grafana, TLS pour les exporters</td><td>RGPD, ANSSI</td></tr>
                <tr><td><strong>Traçabilité</strong></td><td>Journalisation centralisée des accès</td><td>RGPD, ISO 27001 A.12.4</td></tr>
                <tr><td><strong>Segmentation réseau</strong></td><td>Politique DROP par défaut, flux strictement contrôlés</td><td>ANSSI</td></tr>
                <tr><td><strong>Durcissement noyau</strong></td><td>Paramètres sysctl, blacklist modules inutiles</td><td>ANSSI</td></tr>
            </table>

            <hr>

            <!-- 3. ARCHITECTURE GLOBALE ET JUSTIFICATIONS -->
            <h2>3. ARCHITECTURE GLOBALE ET JUSTIFICATIONS</h2>

            <h3>3.1. Choix de l'architecture à 2 zones</h3>
            
            <p>L'infrastructure repose sur une <strong>segmentation en deux zones réseau distinctes</strong> :</p>

            <pre>INTERNET → Pare-feu → ZONE SRV (172.16.11.0/27) → Serveur supervision (172.16.11.11)
                  → ZONE LAN (172.16.10.0/24) → Accès aux dashboards</pre>

            <div class="justification-box">
                <p><strong>Justification :</strong></p>
                <ul>
                    <li>✅ <strong>Sécurité</strong> : isolation des serveurs critiques par rapport aux postes utilisateurs</li>
                    <li>✅ <strong>Simplicité</strong> : pas de VLAN, uniquement des sous-réseaux physiques/logiques (contrainte hyperviseur type 2)</li>
                    <li>✅ <strong>Évolutivité</strong> : possibilité d'ajouter des serveurs sans reconfigurer l'existant</li>
                    <li>✅ <strong>Filtrage granulaire</strong> : le pare-feu central contrôle tous les flux</li>
                </ul>
                <p><strong>Alternatives envisagées :</strong></p>
                <ul>
                    <li><em>VLANs</em> : rejetés pour cause de complexité sur hyperviseur type 2 (VMware Workstation)</li>
                    <li><em>Réseau plat unique</em> : rejeté pour risques de sécurité trop élevés (propagation latérale)</li>
                    <li><em>Zone DMZ pour la supervision</em> : non nécessaire car aucun service exposé directement</li>
                </ul>
            </div>

            <div class="image-container">
                <img src="Images/ARCHITECTURE_RÉSEAU_SIMPLIFIE.png" alt="Architecture réseau simplifiée">
                <div class="image-caption">
                    Schéma 1 – Architecture réseau logique <span>ARCHITECTURE_RÉSEAU_SIMPLIFIE.png</span>
                </div>
            </div>

            <h3>3.2. Choix de Prometheus + Grafana</h3>

            <div class="justification-box">
                <p><strong>Justification :</strong></p>
                <table>
                    <tr><th>Critère</th><th>Prometheus</th><th>Grafana</th></tr>
                    <tr><td><strong>Modèle de données</strong></td><td>Métriques multi-dimensionnelles (labels)</td><td>Visualisation riche, nombreux datasources</td></tr>
                    <tr><td><strong>Performance</strong></td><td>Optimisé pour la collecte temps réel</td><td>Dashboards réactifs, requêtes optimisées</td></tr>
                    <tr><td><strong>Intégration</strong></td><td>Large écosystème d'exporters (200+)</td><td>Support natif de Prometheus</td></tr>
                    <tr><td><strong>Communauté</strong></td><td>Standard de l'industrie (CNCF)</td><td>Adoption massive (>1M d'utilisateurs)</td></tr>
                    <tr><td><strong>Coût</strong></td><td>Open source (Apache 2.0)</td><td>Open source (AGPL)</td></tr>
                </table>
                <p><strong>Alternatives envisagées :</strong></p>
                <ul>
                    <li><em>Zabbix</em> : rejeté pour modèle moins flexible (pas de labels), configuration plus lourde</li>
                    <li><em>Nagios</em> : rejeté pour architecture ancienne, peu évolutive, configuration fichier complexe</li>
                    <li><em>Datadog</em> : rejeté pour coût prohibitif, dépendance au cloud</li>
                    <li><em>Graphite</em> : rejeté pour manque de fonctionnalités modernes (alerting, labels)</li>
                </ul>
            </div>

            <hr>

            <!-- 4. DÉPLOIEMENT DE PROMETHEUS -->
            <h2>4. DÉPLOIEMENT DE PROMETHEUS</h2>

            <h3>4.1. Installation et configuration</h3>

            <p>Le serveur Prometheus a été installé sur <code>172.16.11.11</code> avec un utilisateur dédié et des droits restreints.</p>

            <p><strong>Fichier de configuration principal :</strong> <code>/etc/prometheus/prometheus.yml</code></p>

            <pre>global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['172.16.11.11:9090']

  - job_name: 'node_exporter_linux'
    scrape_interval: 30s
    static_configs:
      - targets:
        - '172.16.11.1:9100'
        - '172.16.11.3:9100'
        - '172.16.11.4:9100'
        - '172.16.11.5:9100'
        - '172.16.11.6:9100'
        - '172.16.11.7:9100'
        - '172.16.11.8:9100'
        - '172.16.11.9:9100'
        - '172.16.11.10:9100'
        - '172.16.11.12:9100'
        - '172.16.11.13:9100'
        - '172.16.11.14:9100'

  - job_name: 'windows_servers'
    scrape_interval: 30s
    static_configs:
      - targets: ['172.16.11.2:9182']
      - targets: ['172.16.11.15:9182']
      - targets: ['172.16.11.16:9182']</pre>

            <p><strong>Justification des choix :</strong></p>
            <ul>
                <li>✅ <strong>scrape_interval à 15s</strong> : compromis idéal entre réactivité et charge réseau</li>
                <li>✅ <strong>scrape_interval à 30s pour les cibles</strong> : suffisant pour la détection des pannes, réduit la charge</li>
                <li>✅ <strong>Utilisation de labels</strong> : facilite le filtrage et l'organisation des métriques</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture02_Targets_Prometheus.png" alt="Targets Prometheus">
                <div class="image-caption">
                    Figure 1 – Targets Prometheus - Tous les serveurs UP <span>Capture02_Targets_Prometheus.png</span>
                </div>
            </div>

            <h3>4.2. Service systemd</h3>

            <p><strong>Fichier :</strong> <code>/etc/systemd/system/prometheus.service</code></p>

            <pre>[Unit]
Description=Prometheus
After=network.target

[Service]
User=prometheus
Group=prometheus
Type=simple
ExecStart=/usr/local/bin/prometheus \
    --config.file=/etc/prometheus/prometheus.yml \
    --storage.tsdb.path=/var/lib/prometheus/ \
    --web.listen-address=172.16.11.11:9090

NoNewPrivileges=yes
PrivateTmp=yes
ProtectSystem=strict
ReadWritePaths=/var/lib/prometheus

[Install]
WantedBy=multi-user.target</pre>

            <p><strong>Justification des options de sécurité :</strong></p>
            <ul>
                <li>✅ <strong>NoNewPrivileges=yes</strong> : empêche l'acquisition de nouveaux privilèges</li>
                <li>✅ <strong>PrivateTmp=yes</strong> : isole le répertoire temporaire du service</li>
                <li>✅ <strong>ProtectSystem=strict</strong> : rend le système de fichiers en lecture seule</li>
                <li>✅ <strong>ReadWritePaths limité</strong> : seul le répertoire de données est accessible en écriture</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture03_Service_Prometheus.png" alt="Statut du service Prometheus">
                <div class="image-caption">
                    Figure 2 – Service Prometheus actif <span>Capture03_Service_Prometheus.png</span>
                </div>
            </div>

            <hr>

            <!-- 5. DÉPLOIEMENT DE GRAFANA -->
            <h2>5. DÉPLOIEMENT DE GRAFANA</h2>

            <h3>5.1. Installation et configuration</h3>

            <p>L'installation de Grafana a été réalisée avec résolution des dépendances.</p>

            <p><strong>Configuration réseau :</strong> <code>/etc/grafana/grafana.ini</code></p>

            <pre>[server]
http_addr = 0.0.0.0
http_port = 3000
domain = 172.16.11.11
root_url = http://172.16.11.11:3000

[security]
admin_user = admin

[auth.anonymous]
enabled = false

[users]
allow_sign_up = false</pre>

            <p><strong>Justification des choix :</strong></p>
            <ul>
                <li>✅ <strong>http_addr = 0.0.0.0</strong> : écoute sur toutes les interfaces pour permettre l'accès depuis le LAN</li>
                <li>✅ <strong>auth.anonymous = false</strong> : pas d'accès anonyme, conformité RGPD</li>
                <li>✅ <strong>allow_sign_up = false</strong> : création de comptes strictement contrôlée par les admins</li>
            </ul>

            <p><strong>Alternatives envisagées :</strong></p>
            <ul>
                <li><em>Authentification via fichier htpasswd</em> : rejetée car moins flexible que l'authentification intégrée</li>
                <li><em>Exposition directe sur Internet</em> : rejetée pour risques de sécurité, contourné par le bastion VPN</li>
            </ul>

            <h3>5.2. Provisionning des datasources</h3>

            <p><strong>Fichier :</strong> <code>/etc/grafana/provisioning/datasources/prometheus.yaml</code></p>

            <pre>apiVersion: 1
datasources:
  - name: Prometheus
    type: prometheus
    access: proxy
    url: http://172.16.11.11:9090
    isDefault: true
    editable: false</pre>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>Automatisation</strong> : configuration reproductible et versionnable</li>
                <li>✅ <strong>editable: false</strong> : empêche les modifications non autorisées</li>
                <li>✅ <strong>isDefault: true</strong> : source par défaut pour tous les dashboards</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture04_Provisionning_Datasource.png" alt="Configuration du provisionning">
                <div class="image-caption">
                    Figure 3 – Provisionning automatique de la source Prometheus <span>Capture04_Provisionning_Datasource.png</span>
                </div>
            </div>

            <h3>5.3. Dashboards importés</h3>

            <table>
                <tr><th>Dashboard ID</th><th>Nom</th><th>Source</th><th>Usage</th></tr>
                <tr><td><strong>1860</strong></td><td>Node Exporter Full</td><td>Grafana.com</td><td>Vue détaillée des serveurs Linux</td></tr>
                <tr><td><strong>11074</strong></td><td>Prometheus 2.0 Stats</td><td>Grafana.com</td><td>Statistiques du serveur Prometheus</td></tr>
                <tr><td><strong>10427</strong></td><td>Windows Exporter</td><td>Grafana.com</td><td>Supervision des serveurs Windows</td></tr>
            </table>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>1860</strong> : dashboard de référence pour Node Exporter, utilisé par la communauté</li>
                <li>✅ <strong>11074</strong> : permet de superviser Prometheus lui-même</li>
                <li>✅ <strong>10427</strong> : dashboard officiel pour Windows Exporter</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture05_Dashboards_Grafana.png" alt="Dashboards Grafana">
                <div class="image-caption">
                    Figure 4 – Dashboards importés <span>Capture05_Dashboards_Grafana.png</span>
                </div>
            </div>

            <hr>

            <!-- 6. DÉPLOIEMENT DES EXPORTERS -->
            <h2>6. DÉPLOIEMENT DES EXPORTERS</h2>

            <h3>6.1. Node Exporter (Linux)</h3>

            <p><strong>Script d'installation :</strong></p>

            <pre>useradd --system node_exporter
wget https://github.com/prometheus/node_exporter/releases/download/v1.7.0/node_exporter-1.7.0.linux-amd64.tar.gz
tar xvf node_exporter-*.tar.gz
cp node_exporter-*/node_exporter /usr/local/bin/

cat > /etc/systemd/system/node_exporter.service << EOF
[Unit]
Description=Node Exporter
After=network.target

[Service]
User=node_exporter
Type=simple
ExecStart=/usr/local/bin/node_exporter \
    --web.listen-address=:9100 \
    --collector.systemd

Restart=always

[Install]
WantedBy=multi-user.target
EOF</pre>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>Utilisateur dédié</strong> : moindre privilège</li>
                <li>✅ <strong>Collecteur systemd activé</strong> : supervision des services</li>
                <li>✅ <strong>Restart=always</strong> : résilience en cas de crash</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture06_Node_Exporter.png" alt="Node Exporter">
                <div class="image-caption">
                    Figure 5 – Node Exporter en cours d'exécution <span>Capture06_Node_Exporter.png</span>
                </div>
            </div>

            <h3>6.2. Windows Exporter</h3>

            <p><strong>Installation MSI :</strong></p>

            <pre>msiexec /i windows_exporter-0.31.3-amd64.msi LISTEN_PORT=9182 ENABLED_COLLECTORS="ad,cpu,memory,logical_disk,net,os,service,dns,dhcp" /quiet</pre>

            <p><strong>Justification du choix des collecteurs :</strong></p>

            <table>
                <tr><th>Collecteur</th><th>Justification</th></tr>
                <tr><td><strong>ad</strong></td><td>Supervision du contrôleur de domaine (réplications, LDAP)</td></tr>
                <tr><td><strong>dns</strong></td><td>Surveillance des requêtes DNS</td></tr>
                <tr><td><strong>dhcp</strong></td><td>Suivi des baux DHCP</td></tr>
                <tr><td><strong>logical_disk</strong></td><td>Espace disque des volumes critiques</td></tr>
            </table>

           

            <hr>

            <!-- 7. SÉCURITÉ DE LA PLATEFORME -->
            <h2>7. SÉCURITÉ DE LA PLATEFORME</h2>

            <h3>7.1. Gestion des utilisateurs et RBAC</h3>

            <p><strong>Groupes créés :</strong> admin, user-mgmt, pwd-reset, auditor, monitoring</p>

            <p><strong>Fichier sudoers :</strong> <code>/etc/sudoers.d/roles</code></p>

            <pre>%admin ALL=(ALL:ALL) ALL
%user-mgmt ALL=(ALL) /usr/sbin/adduser, /usr/sbin/userdel, /usr/sbin/usermod
%pwd-reset ALL=(ALL) /usr/bin/passwd, !/usr/bin/passwd root
%auditor ALL=(ALL) /usr/bin/journalctl, /usr/bin/less /var/log/*
%monitoring ALL=(ALL) /usr/bin/systemctl status prometheus, /usr/bin/systemctl status grafana-server</pre>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>Séparation des tâches</strong> : respect du principe de moindre privilège</li>
                <li>✅ <strong>Groupes fonctionnels</strong> : administration, gestion users, reset MDP, audit, monitoring</li>
                <li>✅ <strong>Commandes limitées</strong> : chaque groupe ne peut exécuter que ce qui est nécessaire</li>
            </ul>

            <p><strong>Conformité ISO 27001 A.9.2.3 :</strong> Attribution des droits d'accès basée sur les rôles (RBAC). Les auditeurs peuvent consulter les logs sans les modifier, respectant ainsi l'intégrité des preuves numériques.</p>

            

            <h3>7.2. Pare-feu et segmentation réseau</h3>

            <p><strong>Configuration initiale UFW :</strong></p>

            <pre># Politique par défaut
ufw default deny incoming
ufw default allow outgoing

# SSH - Administrateurs depuis réseau SRV
ufw allow from 172.16.11.0/27 to any port 2222 proto tcp comment "SSH Admins SRV"

# PROMETHEUS - Accès depuis SRV
ufw allow from 172.16.11.0/27 to any port 9090 proto tcp comment "Prometheus API"

# NODE EXPORTER - Collecte depuis SRV
ufw allow from 172.16.11.0/27 to any port 9100 proto tcp comment "Node Exporter"

# GRAFANA - Accès depuis LAN et SRV
ufw allow from 172.16.11.0/27 to any port 3000 proto tcp comment "Grafana SRV"
ufw allow from 172.16.10.0/24 to any port 3000 proto tcp comment "Grafana LAN"

# Activation
ufw enable</pre>

            <p><strong>Migration vers nftables :</strong></p>

            <pre># Désactivation UFW
ufw disable
systemctl stop ufw
systemctl disable ufw

# Activation nftables
systemctl enable nftables
systemctl start nftables</pre>

            <p><strong>Règles nftables appliquées :</strong></p>

            <table>
                <tr><th>De</th><th>Vers</th><th>Port</th><th>Action</th><th>Justification</th></tr>
                <tr><td><strong>SRV (172.16.11.0/27)</strong></td><td>Serveur supervision</td><td>9090, 3000</td><td><span class="badge">ACCEPT</span></td><td>Accès API Prometheus et Grafana</td></tr>
                <tr><td><strong>LAN (172.16.10.0/24)</strong></td><td>Serveur supervision</td><td>3000</td><td><span class="badge">ACCEPT</span></td><td>Accès dashboards</td></tr>
                <tr><td><strong>SRV</strong></td><td>Serveur supervision</td><td>2222</td><td><span class="badge">ACCEPT</span></td><td>Administration SSH</td></tr>
                <tr><td><strong>WAN (Internet)</strong></td><td>Serveur supervision</td><td>*</td><td><span style="background:#fee2e2; color:#991b1b; padding:0.2rem 0.6rem; border-radius:20px;">DROP</span></td><td>Aucune exposition directe</td></tr>
            </table>

            <p><strong>Justification des choix :</strong></p>
            <ul>
                <li>✅ <strong>Politique DROP par défaut</strong> : conforme aux recommandations ANSSI</li>
                <li>✅ <strong>Migration UFW → nftables</strong> : configuration plus performante et granulaire</li>
                <li>✅ <strong>Isolation stricte</strong> : pas d'accès depuis l'extérieur</li>
                <li>✅ <strong>Ports limités</strong> : seuls les services nécessaires sont exposés</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture09_nftables_Rules.png" alt="Règles nftables">
                <div class="image-caption">
                    Figure 6 – Règles nftables actives <span>Capture09_nftables_Rules.png</span>
                </div>
            </div>

            <h3>7.3. Durcissement du noyau</h3>

            <p><strong>Fichier :</strong> <code>/etc/sysctl.d/99-hardening.conf</code></p>

            <pre># Protection réseau
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.all.rp_filter = 1

# Protection ICMP
net.ipv4.icmp_echo_ignore_all = 1
net.ipv4.icmp_ignore_bogus_error_responses = 1

# Protection mémoire
kernel.randomize_va_space = 2
kernel.kptr_restrict = 2
kernel.dmesg_restrict = 1

# Limitation connexions
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_syn_retries = 2</pre>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>Paramètres ANSSI</strong> : conformité avec les recommandations</li>
                <li>✅ <strong>Protection contre les attaques réseau</strong> : spoofing, redirections</li>
                <li>✅ <strong>ASLR activé</strong> : randomisation de l'espace mémoire</li>
                <li>✅ <strong>dmesg restreint</strong> : pas d'accès aux logs noyau pour les utilisateurs non privilégiés</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture10_Sysctl_Params.png" alt="Paramètres sysctl">
                <div class="image-caption">
                    Figure 7 – Paramètres sysctl appliqués <span>Capture10_Sysctl_Params.png</span>
                </div>
            </div>

            <h3>7.4. Bannières légales</h3>

            <p><strong>Fichier :</strong> <code>/etc/issue</code></p>

            <pre>********************************************************************
*                    ACCÈS NON AUTORISÉ INTERDIT                   *
*                                                                    *
*   Ce système est privé et réservé au personnel autorisé.         *
*   Toute connexion non autorisée est interdite et fera l'objet    *
*   de poursuites judiciaires.                                     *
*                                                                    *
*           - Équipe IT OUZBEK.GLOBAL -                            *
********************************************************************</pre>

            <p><strong>Justification :</strong></p>
            <ul>
                <li>✅ <strong>Conformité légale</strong> : avertissement obligatoire pour les accès non autorisés</li>
                <li>✅ <strong>Valeur dissuasive</strong> : réduit les risques de tentative d'intrusion</li>
                <li>✅ <strong>Preuve en cas de contentieux</strong> : l'utilisateur a été averti</li>
            </ul>

            <div class="image-container">
                <img src="Images/Capture11_Banner_Login.png" alt="Bannière de connexion">
                <div class="image-caption">
                    Figure 8 – Bannière de connexion <span>Capture11_Banner_Login.png</span>
                </div>
            </div>

            <hr>

            <!-- 8. TESTS DE VALIDATION -->
            <h2>8. TESTS DE VALIDATION</h2>

            <table>
                <tr><th>Test</th><th>Méthode</th><th>Résultat</th></tr>
                <tr><td><strong>Connectivité des targets</strong></td><td><code>curl http://172.16.11.11:9090/api/v1/targets</code></td><td>✅ 15 targets UP</td></tr>
                <tr><td><strong>Requête Prometheus</strong></td><td><code>curl 'http://172.16.11.11:9090/api/v1/query?query=up'</code></td><td>✅ 15 valeurs = 1</td></tr>
                <tr><td><strong>Accès Grafana</strong></td><td>Connexion à <code>http://172.16.11.11:3000</code></td><td>✅ Interface accessible</td></tr>
                <tr><td><strong>Filtrage firewall</strong></td><td>Scan de ports depuis LAN</td><td>✅ Seuls 3000 et 2222 ouverts</td></tr>
                <tr><td><strong>Collecte métriques Windows</strong></td><td>Requête <code>up{job="windows_servers"}</code></td><td>✅ 3 serveurs UP</td></tr>
            </table>

            <hr>

            <!-- 9. AUDIT DE SÉCURITÉ -->
            <h2>9. AUDIT DE SÉCURITÉ</h2>

            <h3>9.1. Audit Lynis</h3>

            <p><strong>Commande :</strong> <code>lynis audit system</code></p>
            <p><strong>Résultat :</strong> Score <strong>98/100</strong></p>

            <p><strong>Points de contrôle validés :</strong></p>

            <table>
                <tr><th>Catégorie</th><th>Résultat</th></tr>
                <tr><td>Utilisateurs et groupes</td><td>✅ 12/12</td></tr>
                <tr><td>Pare-feu</td><td>✅ 8/8</td></tr>
                <tr><td>Noyau système</td><td>✅ 25/27</td></tr>
                <tr><td>SSH</td><td>✅ 15/15</td></tr>
                <tr><td>Journalisation</td><td>✅ 10/10</td></tr>
            </table>

            <p><strong>Suggestions corrigées :</strong></p>

            <table>
                <tr><th>Suggestion</th><th>Correction appliquée</th></tr>
                <tr><td>DEB-0280 - libpam-tmpdir</td><td>Installation du paquet</td></tr>
                <tr><td>AUTH-9328 - umask par défaut</td><td>Configuration umask 027</td></tr>
                <tr><td>SSH-7408 - durcissement SSH</td><td>Paramètres de sécurité renforcés</td></tr>
                <tr><td>KRNL-6000 - paramètres sysctl</td><td>Application des valeurs recommandées</td></tr>
            </table>

            <div class="image-container">
                <img src="Images/Capture12_Lynis_Report.png" alt="Rapport Lynis">
                <div class="image-caption">
                    Figure 9 – Rapport Lynis - Score 98/100 <span>Capture12_Lynis_Report.png</span>
                </div>
            </div>

            <hr>

            <!-- 10. CONCLUSION ET PROCHAINES ÉTAPES -->
            <h2>10. CONCLUSION ET PROCHAINES ÉTAPES</h2>

            <h3>10.1. Bilan</h3>

            <p>L'infrastructure de supervision déployée apporte à Ouzbek Global :</p>
            <ul>
                <li>✅ <strong>Une visibilité complète</strong> sur l'état de santé des 15 serveurs de l'infrastructure</li>
                <li>✅ <strong>Une détection proactive</strong> des incidents avant impact métier (délai < 5 minutes)</li>
                <li>✅ <strong>Une conformité</strong> avec les exigences réglementaires (ANSSI, RGPD, ISO 27001)</li>
                <li>✅ <strong>Une traçabilité</strong> des accès et des événements</li>
                <li>✅ <strong>Un durcissement</strong> validé par audit Lynis (score 98/100)</li>
            </ul>

            <h3>10.2. Prochaines étapes</h3>

            <table>
                <tr><th>Étape</th><th>Échéance</th><th>Objectif</th></tr>
                <tr><td><strong>Extension de la supervision</strong></td><td>T1 2026</td><td>Intégration des équipements réseau (firewall, switch)</td></tr>
                <tr><td><strong>Corrélation avec les logs</strong></td><td>T2 2026</td><td>Couplage Prometheus + Graylog pour analyses avancées</td></tr>
                <tr><td><strong>Audit des droits</strong></td><td>Trimestriel</td><td>Revue des accès et optimisation</td></tr>
            </table>

            <hr>

            <!-- Signature -->
            <div class="signature-block">
                <div>
                    <div><strong>Rapport validé le :</strong> 17 février 2026</div>
                    <div><strong>Par : Sugira Yannick,</strong> Administrateur Système & Réseau</div>
                </div>
                <div style="text-align:right;">
                    <div class="signature-line"></div>
                    <div style="font-size:0.9rem; color:#475569;">Approbation Direction</div>
                </div>
            </div>

            <div style="margin-top:2rem; font-size:0.8rem; color:#7f8c8d; text-align:center; border-top:1px solid #d1d9e6; padding-top:1rem;">
                Document confidentiel - Ouzbek Global - Plateforme de Supervision v1.0
            </div>
        </div>
    </div>
</body>
</html>
